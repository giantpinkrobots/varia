{
    "id" : "io.github.giantpinkrobots.varia",
    "runtime" : "org.gnome.Platform",
    "runtime-version" : "49",
    "//!" : "!!!!!!Also update the GNOME version in ./.github/workflows/flatpak-package.yml",
    "sdk" : "org.gnome.Sdk",
    "command" : "varia",
    "//" : "Justifications for the permissions: This program utilizes aria2c, and aria2c requires the networking permission and the xdg-download directory in order to download files. It also has a 'shut down once all downloads are completed' feature that requires access to org.freedesktop.login1.",
    "finish-args" : [
        "--share=network",
        "--share=ipc",
        "--socket=fallback-x11",
        "--device=dri",
        "--socket=wayland",
        "--filesystem=xdg-download",
        "--system-talk-name=org.freedesktop.login1",
        "--talk-name=org.kde.StatusNotifierWatcher"
    ],
    "sdk-extensions" : [
        "org.freedesktop.Sdk.Extension.rust-stable",
        "org.freedesktop.Sdk.Extension.llvm21"
    ],
    "build-options" : {
        "append-path" : "/usr/lib/sdk/rust-stable/bin:/usr/lib/sdk/llvm21/bin",
        "env" : {
            "CARGO_HOME" : "/run/build/rust-flatpak/cargo",
            "CC": "clang",
            "CXX": "clang++"
        }
    },
    "cleanup" : [
        "/include",
        "/lib/pkgconfig",
        "/man",
        "/share/doc",
        "/share/gtk-doc",
        "/share/man",
        "/share/pkgconfig",
        "*.la",
        "*.a"
    ],
    "modules" : [
        {
            "name" : "aria2",
            "buildsystem" : "autotools",
            "config-opts" : [
                "--without-libxml2",
                "--without-sqlite3",
                "--without-appletls",
                "--without-gnutls",
                "--without-libgmp",
                "--without-libnettle",
                "--without-libgcrypt",
                "--without-libssh2",
                "--without-cppunit",
                "--without-libz",
                "--without-libcunit",
                "--without-libcares",
                "--without-libaria2",
                "--disable-nls",
                "--with-openssl",
                "--disable-ftp"
            ],
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://github.com/aria2/aria2/releases/download/release-1.37.0/aria2-1.37.0.tar.xz",
                    "sha256" : "60a420ad7085eb616cb6e2bdf0a7206d68ff3d37fb5a956dc44242eb2f79b66b"
                }
            ]
        },
        {
            "name" : "ffmpeg",
            "config-opts" : [
                "--disable-debug",
                "--disable-devices",
                "--disable-doc",
                "--disable-ffplay",
                "--disable-static",
                "--enable-gnutls",
                "--enable-libmp3lame",
                "--enable-libopus",
                "--enable-libvorbis",
                "--enable-shared"
            ],
            "cleanup" : [
                "/share/ffmpeg"
            ],
            "sources" : [
                {
                    "type" : "archive",
                    "url" : "https://ffmpeg.org/releases/ffmpeg-8.0.tar.xz",
                    "sha256" : "b2751fccb6cc4c77708113cd78b561059b6fa904b24162fa0be2d60273d27b8e"
                }
            ]
        },
        {
            "name" : "7-zip",
            "buildsystem" : "simple",
            "build-commands" :
            [
                "for bundle in Alone2 SFXCon; do pushd CPP/7zip/Bundles/${bundle}; make -j ${FLATPAK_BUILDER_N_JOBS} -f ../../cmpl_gcc.mak; popd; done",
                "install -Dm755 CPP/7zip/Bundles/Alone2/b/g/7zz   $FLATPAK_DEST/bin/7zz"
            ],
            "sources" : [
                {
                    "type" : "git",
                    "url" : "https://github.com/ip7z/7zip.git",
                    "tag" : "25.01",
                    "commit" : "5e96a8279489832924056b1fa82f29d5837c9469"
                }
            ]
        },
        {
            "name": "deno",
            "buildsystem": "simple",
            "build-commands": [
                "cargo fetch --locked --manifest-path Cargo.toml",
                "cargo build --release",
                "install -Dm755 ./target/release/deno -t /app/bin/"
            ],
            "sources": [
                {
                "type": "archive",
                "url": "https://github.com/denoland/deno/archive/refs/tags/v2.6.3.tar.gz",
                "sha256": "3920c3c8ecfe7157a9d2f168fc9d825d1a0791d1fd9710139dc3d1e5050bdb27"
                }
            ]
        },
        "./flatpak_extra_manifests/python3-aria2p.json",
        "./flatpak_extra_manifests/python3-yt-dlp.json",
        "./flatpak_extra_manifests/python3-emoji-country-flag.json",
        "shared-modules/libayatana-appindicator/libayatana-appindicator-gtk3.json",
        {
            "name" : "varia",
            "builddir" : true,
            "buildsystem" : "meson",
            "sources" : [
                {
                    "type" : "dir",
                    "path" : "."
                }
            ],
            "config-opts" : [
                "--libdir=lib"
            ]
        }
    ]
}
